<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<form id="upload-form" action="http://test.jubao56.com/res/file/upload" method="post" enctype="multipart/form-data" >
    　　　<input type="file" id="upload" name="fileVal" /> <br />
    　　　<input type="submit" value="Upload" />
    <progress id="uploadprogress" min="0" max="100" value="0">0</progress>
</form>
</body>
<script src="../libs/jquery-1.9.1.min.js"></script>
<script>
    var form = $("#upload-form");
    form.on('submit',function() {
        // 此处进行ajax上传
        // 检查是否支持FormData
        if(window.FormData) {
            var formData = new FormData();
            // 建立一个upload表单项，值为上传的文件
            formData.append('upload', document.getElementById('upload').files[0]);
            var xhr = new XMLHttpRequest();
            xhr.open('POST', $(this).attr('action'));
            // 定义上传完成后的回调函数
            xhr.onload = function () {
                if (xhr.status === 200) {
                    console.log('上传成功');
                } else {
                    console.log('出错了');
                }
            };
            xhr.send(formData);
            //onprogress
            xhr.upload.onprogress = function (event) {
                if (event.lengthComputable) {
                    var complete = (event.loaded / event.total * 100 | 0);
                    var progress = document.getElementById('uploadprogress');
                    progress.value = progress.innerHTML = complete;
                }
            };
            //图片预览
            // 检查是否支持FileReader对象
            if (typeof FileReader != 'undefined') {
                var acceptedTypes = {
                    'image/png': true,
                    'image/jpeg': true,
                    'image/gif': true
                };
                if (acceptedTypes[document.getElementById('upload').files[0].type] === true) {
                    var reader = new FileReader();
                    reader.onload = function (event) {
                        var image = new Image();
                        image.src = event.target.result;
                        image.width = 100;
                        document.body.appendChild(image);
                    };
                    reader.readAsDataURL(document.getElementById('upload').files[0]);
                }
            }
        }
    });

</script>
</html>