<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>7</title>
</head>
<body>
<form id="upload-form" action="http://test.jubao56.com/res/file/upload" method="post" enctype="multipart/form-data" >
    　　　<input type="file" id="upload" name="fileVal" onchange="postFile()"/> <br />
    　　　<input type="submit" value="Upload" />
</form>
XMLHttpRequest对象的主要属性<br/><br/>

xhr.readyState：XMLHttpRequest对象的状态，等于4表示数据已经接收完毕。<br/>
xhr.status：服务器返回的状态码，等于200表示一切正常。<br/>
xhr.responseText：服务器返回的文本数据<br/>
xhr.responseXML：服务器返回的XML格式的数据<br/>
xhr.statusText：服务器返回的状态文本。<br/>
新版本XMLHttpRequest的新功能<br/><br/>

可以设置HTTP请求的时限。<br/>
可以使用FormData对象管理表单数据。<br/>
可以上传文件。<br/>
可以请求不同域名下的数据（跨域请求）。<br/>
可以获取服务器端的二进制数据。<br/>
可以获得数据传输的进度信息。<br/>
</body>
<script src="../libs/jquery-1.9.1.min.js"></script>
<script>
    function postFile() {
        var xhr = new XMLHttpRequest();
        var form = document.getElementById('upload-form');
        var formData = new FormData(form);
        xhr.open('POST', form.action);
        xhr.send(formData);
        xhr.onreadystatechange = function() {
            if(xhr.readyState == 4 && xhr.status == 200) {
                console.log(JSON.parse(xhr.responseText));
                console.log("=====success============")
            }else{
                console.log(xhr.statusText);
                console.log("===error======")
            }
        };
        xhr.timeout = 2000;
        xhr.ontimeout = function(event){
            alert('请求超时！');
        };
    }

//    var formData = new FormData();
//    formData.append('username','张三');
//    formData.append('id', '1234');
//    xhr.send(formData);
//    var form = document.getElementById('upload-form');
//    var formData = new FormData(form);
////    formData.append('secret', '123456'); // 添加一个表单项
//    xhr.open('POST', "http://test.jubao56.com/res/file/upload");
//    xhr.send(formData);
</script>
</html>