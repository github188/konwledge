<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<button type="button" onclick="submit()">按钮</button>
</body>
<script src="jquery-1.9.1.min.js"></script>
<script src="json2Excel.js"></script>
<script>
    function translateName(name) {
        return name+"帅哥"
    }

    function submit() {
        $.ajax({
            url: "2.json",
            type: "get",
            dataType:"text",
            success: function(res) {
                res=JSON.parse(res);
                loadExcel(res.rows,"投保清单","sheet")
            }
        })

        /**
         * 自定义的函数，前提要求为：json中的数据格式统一；
         * 输入的结果为：以rows中的每个对象的键值为表头
         * @param rows
         * @param filename
         * @param sheetname
         */
        function loadExcel(rows, filename, sheetname) {
            var sheetheader = [];
            for(var i in  rows[0]){
                sheetheader.push(i)
            }

            var toExcel=new ExportJsonExcel({
                fileName:filename,
                datas:[
                    {
                        sheetData:rows,//数据
                        sheetName: sheetname,
                        sheetHeader:sheetheader,//设置表头
                    }
                ]
            });
            toExcel.saveExcel();
        }
    }
</script>
</html>